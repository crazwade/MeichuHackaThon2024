var it=Object.defineProperty;var st=(e,t,i)=>t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var n=(e,t,i)=>st(e,typeof t!="symbol"?t+"":t,i);import{t as nt,d as O,p as H,i as k,q as y,w as J,o as u,c as E,a as r,b as at,s as q,e as W,v as ot,u as m,f as T,h as C,g as I,F as rt,r as X,n as G,j as K,m as Q,l as lt}from"./index-C7_S1REV.js";import{g as N,L as ct}from"./LoadingDialog-cjYYAc9v.js";async function ht(e){const{id:t}=e;try{const i=await new Promise((s,a)=>{setTimeout(()=>{s(dt[t])},1500)});return nt({code:"0001",msg:"success",data:i})}catch(i){throw console.error("Error fetching fuzzy search list:",i),new Error("Failed to fetch fuzzy search list")}}const dt={1:{id:1,destination:"城隍廟前廣場",location:"國立陽明交通大學體育館",costTime:"35m",arrivalTime:"09:04",transportComp:{公車:84,Bike:0,步行:16,共乘:0},crowding:0,path_details:[{location:{gps:{lat:"120.99573786220625",lng:"24.788946082114585"},name:"國立陽明交通大學體育館"},destination:{gps:{lat:"120.99754927480843",lng:"24.796508074536952"},name:"清華大學"},costTime:"16分",arrivalTime:"08:00",transport:{type:"步行",remark:"步行"},crowding:2},{location:{gps:{lat:"120.99754927480843",lng:"24.796508074536952"},name:"清華大學"},destination:{gps:{lat:" 120.97101060750855",lng:"24.803320896069028"},name:"新竹火車站(中正路)"},costTime:"11分",arrivalTime:"08:13",transport:{type:"公車",remark:"5608"},crowding:4},{location:{gps:{lat:" 120.97101060750855",lng:"24.803320896069028"},name:"新竹火車站(中正路)"},destination:{gps:{lat:" 120.96593168750877",lng:"24.80445711912709"},name:"新竹都城隍廟"},costTime:"8分",arrivalTime:"08:13",transport:{type:"步行",remark:"步行"},crowding:4}]},2:{id:2,destination:"城隍廟前廣場",location:"國立陽明交通大學體育館",costTime:"42m",arrivalTime:"09:04",transportComp:{公車:90,Bike:0,步行:10,共乘:0},crowding:0,path_details:[{location:{gps:{lat:"120.99573786220625",lng:"24.788946082114585"},name:"國立陽明交通大學體育館"},destination:{gps:{lat:"120.99941877283285",lng:"24.788299026754014"},name:"交大光復校區"},costTime:"7分",arrivalTime:"08:00",transport:{type:"步行",remark:"步行"},crowding:2},{location:{gps:{lat:"120.99941877283285",lng:"24.788299026754014"},name:"交大光復校區"},destination:{gps:{lat:"120.96933763923636",lng:"24.80548842304441"},name:"東門市場"},costTime:"28分",arrivalTime:"08:13",transport:{type:"公車",remark:"2A經建功高中"},crowding:4},{location:{gps:{lat:"120.96933763923636",lng:"24.80548842304441"},name:"東門市場"},destination:{gps:{lat:"120.96597468181294",lng:"24.805040672214925"},name:"城隍廟前廣場"},costTime:"7分",arrivalTime:"08:23",transport:{type:"步行",remark:"步行"},crowding:1}]},3:{id:3,destination:"城隍廟前廣場",location:"國立陽明交通大學體育館",costTime:"51m",arrivalTime:"09:04",transportComp:{公車:0,Bike:20,步行:53,共乘:27},crowding:0,path_details:[{location:{gps:{lat:"120.99573786220625",lng:"24.788946082114585"},name:"國立陽明交通大學體育館"},destination:{gps:{lat:"120.99939195216426",lng:"24.788310883357507"},name:"交大光復校區"},costTime:"7分",arrivalTime:"08:00",transport:{type:"步行",remark:"步行"},crowding:2},{location:{gps:{lat:"120.99939195216426",lng:"24.788310883357507"},name:"交大光復校區"},destination:{gps:{lat:"121.00240561038945",lng:"24.79267822031121"},name:"陽明交大光復路(過溝)"},costTime:"14分",arrivalTime:"08:23",transport:{type:"步行",remark:"步行"},crowding:1},{location:{gps:{lat:"121.00240561038945",lng:"24.79267822031121"},name:"陽明交大光復路(過溝)"},destination:{gps:{lat:"120.98310352069274",lng:"24.802410321639847"},name:"食品路口"},costTime:"14分",arrivalTime:"08:23",transport:{type:"共乘",remark:"動物園線"},crowding:1},{location:{gps:{lat:"120.98310352069274",lng:"24.802410321639847"},name:"食品路口"},destination:{gps:{lat:"120.98096502386976",lng:"24.800197579066086"},name:"YouBike 新竹動物園"},costTime:"6分",arrivalTime:"08:23",transport:{type:"步行",remark:"步行"},crowding:1},{location:{gps:{lat:"120.98096502386976",lng:"24.800197579066086"},name:"YouBike 新竹動物園"},destination:{gps:{lat:"120.96599065443802",lng:"24.80477590112634"},name:"城隍廟前廣場"},costTime:"10分",arrivalTime:"08:23",transport:{type:"Bike",remark:"新竹動物園站"},crowding:1}]}};function ut(){return Math.random().toString(16).substring(2)}var U=O({props:{diameter:{type:Number,required:!1,default:200},totalSteps:{type:Number,required:!0,default:10},completedSteps:{type:Number,required:!0,default:0},startColor:{type:String,required:!1,default:"#00C58E"},stopColor:{type:String,required:!1,default:"#00E0A1"},innerStrokeColor:{type:String,required:!1,default:"#2F495E"},strokeWidth:{type:Number,required:!1,default:10},innerStrokeWidth:{type:Number,required:!1,default:10},strokeLinecap:{type:String,required:!1,default:"round"},animateSpeed:{type:Number,required:!1,default:1e3},fps:{type:Number,required:!1,default:60},timingFunc:{type:String,required:!1,default:"linear"},isClockwise:{type:Boolean,required:!1,default:!0}},setup(e){const t=H({fx:.99,fy:.5,cx:.5,cy:.5,r:.65}),i=`rg-${ut()}`,s=k(0),a=k(0),l=k(null),h=y(()=>e.diameter/2),o=y(()=>e.diameter-e.innerStrokeWidth*2),c=y(()=>Math.PI*o.value),p=y(()=>e.totalSteps===0?0:100/e.totalSteps),x=y(()=>p.value*e.completedSteps),S=y(()=>2*Math.PI/e.totalSteps),z=y(()=>100/e.fps),d=y(()=>e.animateSpeed/z.value),f=y(()=>S.value/d.value),P=y(()=>o.value/2),g=y(()=>({height:`${e.diameter}px`,width:`${e.diameter}px`})),w=y(()=>({height:`${e.diameter}px`,width:`${e.diameter}px`,strokeWidth:`${e.strokeWidth}px`,strokeDashoffset:s.value,transition:`stroke-dashoffset ${e.animateSpeed}ms ${e.timingFunc}`})),B=y(()=>({height:`${e.diameter}px`,width:`${e.diameter}px`,strokeWidth:`${e.innerStrokeWidth}px`})),v=y(()=>({width:`${o.value}px`}));J(()=>[e.diameter,e.totalSteps,e.completedSteps,e.strokeWidth],et,{immediate:!0});function b(_){const R=.5+.5*Math.cos(_),D=.5+.5*Math.sin(_);return{x:R,y:D}}function j(){const _=b(a.value);_.x&&_.y&&(t.fx=_.x,t.fy=_.y)}function tt(){return e.isClockwise?1:-1}function et(){s.value=(100-x.value)/100*c.value*tt(),l.value&&clearInterval(l.value);const _=(e.completedSteps-1)*S.value;let M=(a.value-_)/f.value;const R=Math.abs(M-d.value)/d.value,D=M<d.value;l.value=setInterval(()=>{if(D&&M>=d.value||!D&&M<d.value){l.value&&clearInterval(l.value);return}a.value=_+f.value*M,j(),M+=D?R:-R},z.value)}return{gradientAnimation:l,innerCircleRadius:P,radialGradientId:i,strokeDashoffset:s,innerCircleStyle:v,containerStyle:g,circumference:c,progressStyle:w,currentAngle:a,strokeStyle:B,gradient:t,radius:h}}});const pt=["width","height"],mt=["id","fx","fy","cx","cy","r"],ft=["stop-color"],gt=["stop-color"],vt=["r","cx","cy","stroke","stroke-dasharray","stroke-linecap"],yt=["transform","r","cx","cy","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap"];function xt(e,t,i,s,a,l){return u(),E("div",{class:"vrp__wrapper",style:q(e.containerStyle)},[r("div",{class:"vrp__inner",style:q(e.innerCircleStyle)},[at(e.$slots,"default")],4),(u(),E("svg",{width:e.diameter,height:e.diameter,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[r("defs",null,[r("radialGradient",{id:e.radialGradientId,fx:e.gradient.fx,fy:e.gradient.fy,cx:e.gradient.cx,cy:e.gradient.cy,r:e.gradient.r},[r("stop",{offset:"30%","stop-color":e.startColor},null,8,ft),r("stop",{offset:"100%","stop-color":e.stopColor},null,8,gt)],8,mt)]),r("circle",{r:e.innerCircleRadius,cx:e.radius,cy:e.radius,fill:"transparent",stroke:e.innerStrokeColor,"stroke-dasharray":e.circumference,"stroke-dashoffset":"0","stroke-linecap":e.strokeLinecap,style:q(e.strokeStyle)},null,12,vt),r("circle",{transform:"rotate(270, "+e.radius+","+e.radius+")",r:e.innerCircleRadius,cx:e.radius,cy:e.radius,fill:"transparent",stroke:`url('#${e.radialGradientId}')`,"stroke-dasharray":e.circumference,"stroke-dashoffset":e.circumference,"stroke-linecap":e.strokeLinecap,style:q(e.progressStyle)},null,12,yt)],8,pt))],4)}function wt(e,t){t===void 0&&(t={});var i=t.insertAt;if(!(typeof document>"u")){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var bt=`
.vrp__wrapper[data-v-6a0cf1f6] {\r
  position: relative;
}
.vrp__inner[data-v-6a0cf1f6] {\r
  position: absolute;\r
  top: 0;\r
  right: 0;\r
  bottom: 0;\r
  left: 0;\r
  border-radius: 50%;\r
  margin: 0 auto;\r
  display: flex;\r
  flex-direction: column;\r
  align-items: center;\r
  justify-content: center;
}\r
`;wt(bt);U.render=xt;U.__scopeId="data-v-6a0cf1f6";var kt=(()=>{const e=U;return e.install=t=>{t.component("RadialProgressBar",e)},e})();const St={class:"w-full h-fit flex justify-center items-center"},_t={class:"flex flex-col justify-center items-center"},Ct={class:"text-xl font-extrabold"},Tt={class:"flex flex-col gap-1"},$t={class:"text-2xl font-semibold text-center"},Et={class:"flex flex-col gap-1"},Pt={class:"flex flex-col text-2xl py-2"},zt={key:0},Bt={key:2,class:"flex justify-center items-center gap-2"},It={class:"text-xl"},Mt={key:3,class:"flex justify-center items-center gap-2"},Lt={class:"text-xl"},Dt={key:4,class:"flex justify-center items-center gap-2"},Ot={class:"text-xl"},jt=O({__name:"SideInfo",props:{costTime:{},completedSteps:{},totalSteps:{},transport:{}},setup(e){return(t,i)=>{const s=X("font-awesome-icon");return u(),E(rt,null,[r("div",St,[W(m(kt),{diameter:110,"completed-steps":t.completedSteps,"total-steps":t.totalSteps},{default:ot(()=>[r("div",_t,[i[0]||(i[0]=r("div",{class:"text-lg font-extrabold"},"抵達:",-1)),r("span",Ct,T(t.completedSteps)+" / "+T(t.totalSteps),1)])]),_:1},8,["completed-steps","total-steps"])]),i[3]||(i[3]=r("div",{class:"h-[2px] w-full bg-white opacity-30 my-4 text-white"},null,-1)),r("div",Tt,[i[1]||(i[1]=r("div",{class:"text-sm opacity-70"},"估計花費時間",-1)),r("div",$t,T(t.costTime),1)]),i[4]||(i[4]=r("div",{class:"h-[2px] w-full bg-white opacity-30 my-4"},null,-1)),r("div",Et,[i[2]||(i[2]=r("div",{class:"text-sm opacity-70"},"交通種類",-1)),r("div",Pt,[t.transport.type?C("",!0):(u(),E("div",zt,"-")),t.transport.type==="步行"?(u(),I(s,{key:1,icon:["fas","shoe-prints"]})):C("",!0),t.transport.type==="Bike"?(u(),E("div",Bt,[t.transport.type==="Bike"?(u(),I(s,{key:0,icon:["fas","bicycle"]})):C("",!0),r("div",It,T(t.transport.remark),1)])):C("",!0),t.transport.type==="公車"?(u(),E("div",Mt,[t.transport.type==="公車"?(u(),I(s,{key:0,icon:["fas","bus"]})):C("",!0),r("div",Lt,T(t.transport.remark)+" 號",1)])):C("",!0),t.transport.type==="共乘"?(u(),E("div",Dt,[t.transport.type==="共乘"?(u(),I(s,{key:0,icon:["fas","car-side"]})):C("",!0),r("div",Ot,T(t.transport.remark),1)])):C("",!0)])])],64)}}}),Rt={class:"w-full h-full flex justify-around items-center"},qt={class:"w-full py-5 px-8 flex justify-center items-center"},Wt={class:"w-fit whitespace-nowrap text-xl font-bold"},Nt={class:"w-fit whitespace-nowrap text-xl font-bold"},At=O({__name:"BottomInfo",props:{data:{},hasNextStep:{type:Boolean,default:!1},hasPreviousStep:{type:Boolean,default:!1}},emits:["nextStep","previousStep"],setup(e,{emit:t}){const i=t,s=k(!1),a=()=>{s.value=!0,setTimeout(()=>{s.value=!1},500)},l=()=>{s.value||(i("previousStep"),a())},h=()=>{s.value||(i("nextStep"),a())};return(o,c)=>{var x,S;const p=X("font-awesome-icon");return u(),E("div",Rt,[r("div",{class:G(["text-2xl flex justify-center px-12 py-4 rounded-full bg-gray-500 cursor-pointer w-[65px]",[o.hasPreviousStep?"hover:bg-gray-600":"opacity-50"]]),onClick:l},[W(p,{icon:["fas","backward-step"]})],2),r("div",qt,[r("div",Wt,T(((x=o.data.location)==null?void 0:x.name)??"-"),1),c[0]||(c[0]=r("div",{class:"w-full h-full border-[2px] border-dashed border-white mx-8 max-w-[300px]"},null,-1)),r("div",Nt,T(((S=o.data.destination)==null?void 0:S.name)??"-"),1)]),r("div",{class:G(["text-2xl flex justify-center px-12 py-4 rounded-full cursor-pointer w-[65px]",[o.hasNextStep?"bg-gray-500 hover:bg-gray-600":"bg-green-400 hover:bg-green-500"]]),onClick:h},[o.hasNextStep?(u(),I(p,{key:1,icon:["fas","forward-step"]})):(u(),I(p,{key:0,icon:["fas","street-view"]}))],2)])}}});function A(e){return Math.abs(Math.floor(e))}function L(e,t){return Math.random()*(t-e)+e}function $(e,t){return Math.floor(L(e,t+1))}function V(e,t,i,s){const a=Math.pow;return Math.sqrt(a(e-i,2)+a(t-s,2))}function F(e,t,i=1){if(e>360||e<0)throw new Error(`Expected hue 0-360 range, got \`${e}\``);if(t>100||t<0)throw new Error(`Expected lightness 0-100 range, got \`${t}\``);if(i>1||i<0)throw new Error(`Expected alpha 0-1 range, got \`${i}\``);return`hsla(${e}, 100%, ${t}%, ${i})`}const Y=e=>{if(typeof e=="object"&&e!==null){if(typeof Object.getPrototypeOf=="function"){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}return!1},Ft=["__proto__","constructor","prototype"],Z=(...e)=>e.reduce((t,i)=>(Object.keys(i).forEach(s=>{Ft.includes(s)||(Array.isArray(t[s])&&Array.isArray(i[s])?t[s]=i[s]:Y(t[s])&&Y(i[s])?t[s]=Z(t[s],i[s]):t[s]=i[s])}),t),{});function Ut(e,t){let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout(()=>e(...s),t)}}class Gt{constructor({x:t,y:i,ctx:s,hue:a,decay:l,gravity:h,friction:o,brightness:c,flickering:p,lineWidth:x,explosionLength:S}){n(this,"x");n(this,"y");n(this,"ctx");n(this,"hue");n(this,"friction");n(this,"gravity");n(this,"flickering");n(this,"lineWidth");n(this,"explosionLength");n(this,"angle");n(this,"speed");n(this,"brightness");n(this,"coordinates",[]);n(this,"decay");n(this,"alpha",1);for(this.x=t,this.y=i,this.ctx=s,this.hue=a,this.gravity=h,this.friction=o,this.flickering=p,this.lineWidth=x,this.explosionLength=S,this.angle=L(0,Math.PI*2),this.speed=$(1,10),this.brightness=$(c.min,c.max),this.decay=L(l.min,l.max);this.explosionLength--;)this.coordinates.push([t,i])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&t()}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.fillStyle=F(this.hue,this.brightness,this.alpha),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=F(this.hue,this.flickering?L(0,this.brightness):this.brightness,this.alpha),this.ctx.stroke()}}class Vt{constructor(t,i){n(this,"active",!1);n(this,"x");n(this,"y");this.options=t,this.canvas=i,this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this)}get mouseOptions(){return this.options.mouse}mount(){this.canvas.addEventListener("pointerdown",this.pointerDown),this.canvas.addEventListener("pointerup",this.pointerUp),this.canvas.addEventListener("pointermove",this.pointerMove)}unmount(){this.canvas.removeEventListener("pointerdown",this.pointerDown),this.canvas.removeEventListener("pointerup",this.pointerUp),this.canvas.removeEventListener("pointermove",this.pointerMove)}usePointer(t,i){const{click:s,move:a}=this.mouseOptions;(s||a)&&(this.x=t.pageX-this.canvas.offsetLeft,this.y=t.pageY-this.canvas.offsetTop,this.active=i)}pointerDown(t){this.usePointer(t,this.mouseOptions.click)}pointerUp(t){this.usePointer(t,!1)}pointerMove(t){this.usePointer(t,this.active)}}class Yt{constructor(){n(this,"hue");n(this,"rocketsPoint");n(this,"opacity");n(this,"acceleration");n(this,"friction");n(this,"gravity");n(this,"particles");n(this,"explosion");n(this,"mouse");n(this,"boundaries");n(this,"sound");n(this,"delay");n(this,"brightness");n(this,"decay");n(this,"flickering");n(this,"intensity");n(this,"traceLength");n(this,"traceSpeed");n(this,"lineWidth");n(this,"lineStyle");n(this,"autoresize");this.autoresize=!0,this.lineStyle="round",this.flickering=50,this.traceLength=3,this.traceSpeed=10,this.intensity=30,this.explosion=5,this.gravity=1.5,this.opacity=.5,this.particles=50,this.friction=.95,this.acceleration=1.05,this.hue={min:0,max:360},this.rocketsPoint={min:50,max:50},this.lineWidth={explosion:{min:1,max:3},trace:{min:1,max:2}},this.mouse={click:!1,move:!1,max:1},this.delay={min:30,max:60},this.brightness={min:50,max:80},this.decay={min:.015,max:.03},this.sound={enabled:!1,files:["explosion0.mp3","explosion1.mp3","explosion2.mp3"],volume:{min:4,max:8}},this.boundaries={debug:!1,height:0,width:0,x:50,y:50}}update(t){Object.assign(this,Z(this,t))}}class Ht{constructor(t,i){n(this,"tick",0);n(this,"rafId",0);n(this,"fps",60);n(this,"tolerance",.1);n(this,"now");this.options=t,this.render=i}mount(){this.now=performance.now();const t=1e3/this.fps,i=s=>{this.rafId=requestAnimationFrame(i);const a=s-this.now;a>=t-this.tolerance&&(this.render(),this.now=s-a%t,this.tick+=a*(this.options.intensity*Math.PI)/1e3)};this.rafId=requestAnimationFrame(i)}unmount(){cancelAnimationFrame(this.rafId)}}class Jt{constructor(t,i,s){n(this,"resizer");this.options=t,this.updateSize=i,this.container=s}mount(){if(!this.resizer){const t=Ut(()=>this.updateSize(),100);this.resizer=new ResizeObserver(t)}this.options.autoresize&&this.resizer.observe(this.container)}unmount(){this.resizer&&this.resizer.unobserve(this.container)}}class Xt{constructor(t){n(this,"buffers",[]);n(this,"audioContext");n(this,"onInit",!1);this.options=t,this.init()}get isEnabled(){return this.options.sound.enabled}get soundOptions(){return this.options.sound}init(){!this.onInit&&this.isEnabled&&(this.onInit=!0,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSounds())}async loadSounds(){for(const t of this.soundOptions.files){const i=await(await fetch(t)).arrayBuffer();this.audioContext.decodeAudioData(i).then(s=>{this.buffers.push(s)}).catch(s=>{throw s})}}play(){if(this.isEnabled&&this.buffers.length){const t=this.audioContext.createBufferSource(),i=this.buffers[$(0,this.buffers.length-1)],s=this.audioContext.createGain();t.buffer=i,s.gain.value=L(this.soundOptions.volume.min/100,this.soundOptions.volume.max/100),s.connect(this.audioContext.destination),t.connect(s),t.start(0)}else this.init()}}class Kt{constructor({x:t,y:i,dx:s,dy:a,ctx:l,hue:h,speed:o,traceLength:c,acceleration:p}){n(this,"x");n(this,"y");n(this,"sx");n(this,"sy");n(this,"dx");n(this,"dy");n(this,"ctx");n(this,"hue");n(this,"speed");n(this,"acceleration");n(this,"traceLength");n(this,"totalDistance");n(this,"angle");n(this,"brightness");n(this,"coordinates",[]);n(this,"currentDistance",0);for(this.x=t,this.y=i,this.sx=t,this.sy=i,this.dx=s,this.dy=a,this.ctx=l,this.hue=h,this.speed=o,this.traceLength=c,this.acceleration=p,this.totalDistance=V(t,i,s,a),this.angle=Math.atan2(a-i,s-t),this.brightness=$(50,70);this.traceLength--;)this.coordinates.push([t,i])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.acceleration;const i=Math.cos(this.angle)*this.speed,s=Math.sin(this.angle)*this.speed;this.currentDistance=V(this.sx,this.sy,this.x+i,this.y+s),this.currentDistance>=this.totalDistance?t(this.dx,this.dy,this.hue):(this.x+=i,this.y+=s)}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=F(this.hue,this.brightness),this.ctx.stroke()}}class Qt{constructor(t,i={}){n(this,"target");n(this,"container");n(this,"canvas");n(this,"ctx");n(this,"width");n(this,"height");n(this,"traces",[]);n(this,"explosions",[]);n(this,"waitStopRaf");n(this,"running",!1);n(this,"opts");n(this,"sound");n(this,"resize");n(this,"mouse");n(this,"raf");this.target=t,this.container=t,this.opts=new Yt,this.createCanvas(this.target),this.updateOptions(i),this.sound=new Xt(this.opts),this.resize=new Jt(this.opts,this.updateSize.bind(this),this.container),this.mouse=new Vt(this.opts,this.canvas),this.raf=new Ht(this.opts,this.render.bind(this))}get isRunning(){return this.running}get version(){return"2.10.8"}get currentOptions(){return this.opts}start(){this.running||(this.canvas.isConnected||this.createCanvas(this.target),this.running=!0,this.resize.mount(),this.mouse.mount(),this.raf.mount())}stop(t=!1){this.running&&(this.running=!1,this.resize.unmount(),this.mouse.unmount(),this.raf.unmount(),this.clear(),t&&this.canvas.remove())}async waitStop(t){if(this.running)return new Promise(i=>{this.waitStopRaf=()=>{this.waitStopRaf&&(requestAnimationFrame(this.waitStopRaf),!this.traces.length&&!this.explosions.length&&(this.waitStopRaf=null,this.stop(t),i()))},this.waitStopRaf()})}pause(){this.running=!this.running,this.running?this.raf.mount():this.raf.unmount()}clear(){this.ctx&&(this.traces=[],this.explosions=[],this.ctx.clearRect(0,0,this.width,this.height))}launch(t=1){for(let i=0;i<t;i++)this.createTrace();this.waitStopRaf||(this.start(),this.waitStop())}updateOptions(t){this.opts.update(t)}updateSize({width:t=this.container.clientWidth,height:i=this.container.clientHeight}={}){this.width=t,this.height=i,this.canvas.width=t,this.canvas.height=i,this.updateBoundaries({...this.opts.boundaries,width:t,height:i})}updateBoundaries(t){this.updateOptions({boundaries:t})}createCanvas(t){t instanceof HTMLCanvasElement?(t.isConnected||document.body.append(t),this.canvas=t):(this.canvas=document.createElement("canvas"),this.container.append(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.updateSize()}render(){if(!this.ctx||!this.running)return;const{opacity:t,lineStyle:i,lineWidth:s}=this.opts;this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle=`rgba(0, 0, 0, ${t})`,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="lighter",this.ctx.lineCap=i,this.ctx.lineJoin="round",this.ctx.lineWidth=L(s.trace.min,s.trace.max),this.initTrace(),this.drawTrace(),this.drawExplosion()}createTrace(){const{hue:t,rocketsPoint:i,boundaries:s,traceLength:a,traceSpeed:l,acceleration:h,mouse:o}=this.opts;this.traces.push(new Kt({x:this.width*$(i.min,i.max)/100,y:this.height,dx:this.mouse.x&&o.move||this.mouse.active?this.mouse.x:$(s.x,s.width-s.x*2),dy:this.mouse.y&&o.move||this.mouse.active?this.mouse.y:$(s.y,s.height*.5),ctx:this.ctx,hue:$(t.min,t.max),speed:l,acceleration:h,traceLength:A(a)}))}initTrace(){if(this.waitStopRaf)return;const{delay:t,mouse:i}=this.opts;(this.raf.tick>$(t.min,t.max)||this.mouse.active&&i.max>this.traces.length)&&(this.createTrace(),this.raf.tick=0)}drawTrace(){let t=this.traces.length;for(;t--;)this.traces[t].draw(),this.traces[t].update((i,s,a)=>{this.initExplosion(i,s,a),this.sound.play(),this.traces.splice(t,1)})}initExplosion(t,i,s){const{particles:a,flickering:l,lineWidth:h,explosion:o,brightness:c,friction:p,gravity:x,decay:S}=this.opts;let z=A(a);for(;z--;)this.explosions.push(new Gt({x:t,y:i,ctx:this.ctx,hue:s,friction:p,gravity:x,flickering:$(0,100)<=l,lineWidth:L(h.explosion.min,h.explosion.max),explosionLength:A(o),brightness:c,decay:S}))}drawExplosion(){let t=this.explosions.length;for(;t--;)this.explosions[t].draw(),this.explosions[t].update(()=>{this.explosions.splice(t,1)})}}const Zt={class:"z-20 absolute w-[100dvw] h-[100dvh] top-0 left-0",id:"firework"},te={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/3 h-1/3 rounded-xl bg-gray-800 text-black flex flex-col justify-center items-center p-8"},ee={class:"h-full p-6 text-5xl text-white font-extrabold flex justify-center items-center"},ie=O({__name:"PopUpDoalog",props:{title:{}},emits:["close"],setup(e,{emit:t}){const i=Q(),s=t,a=k(null),l=k(null),h=()=>{l.value.stop(),s("close"),i.push({name:"home"})};return K(()=>{a.value=document.getElementById("firework"),l.value=new Qt(a.value,{autoresize:!0,opacity:.9,acceleration:1.05,friction:.97,gravity:1.5,particles:50,traceLength:3,traceSpeed:10,explosion:5,intensity:30,flickering:50,lineStyle:"round",hue:{min:0,max:360},delay:{min:30,max:60},rocketsPoint:{min:50,max:50},lineWidth:{explosion:{min:1,max:3},trace:{min:1,max:2}},brightness:{min:50,max:80},decay:{min:.015,max:.03},mouse:{click:!1,move:!1,max:1}}),e.title==="抵達"&&l.value.start()}),(o,c)=>(u(),E("div",Zt,[c[0]||(c[0]=r("div",{class:"absolute top-0 left-0 w-full h-full backdrop-blur-[1px]"},null,-1)),r("div",te,[r("div",ee,T(o.title),1),r("button",{class:"w-full py-2 rounded-full bg-gray-400 hover:bg-gray-500 text-2xl font-bold",onClick:h}," 結束 ")])]))}}),se={class:"relative w-full h-full flex flex-col items-center p-4 text-white"},ne={class:"z-20 absolute top-4 text-[1.5rem] font-extrabold text-white bg-gray-800 py-2 px-5 rounded-lg"},ae={class:"z-20 absolute w-fit h-fit top-24 left-10 flex flex-col px-5 py-4 bg-gray-800 rounded-xl select-none"},oe={class:"z-20 absolute bottom-2 mx-6 bg-gray-800 bg-opacity-85 w-5/6 px-6 py-4 rounded-xl select-none"},he=O({__name:"PathPage",setup(e){const t=lt(),i=Q(),s=k(""),a=k(0),l=H({id:0,destination:"-",location:"-",costTime:"-",arrivalTime:"-",transportComp:{公車:0,Bike:0,步行:0},crowding:0,path_details:[]}),h=k(null),o=k(0),c=k(0),p=k(!1),x=k(!1),S=d=>{var f,P;if(d==="next"){if(o.value===c.value)return;o.value++;const{destination:g,location:w}=l.path_details[o.value],B=[{lng:w.gps.lng,lat:w.gps.lat},{lng:g.gps.lng,lat:g.gps.lat}],v=document.createElement("div"),b=document.getElementById(`map${a.value}`);b&&b.remove(),a.value=Date.now(),v.id="map"+a.value.toString(),(f=h.value)==null||f.appendChild(v),document.getElementById(v.id).style.height="100dvh",document.getElementById(v.id).style.width="100dvw",N(B,v.id),o.value===c.value&&z("抵達")}if(d==="pervious"){if(o.value===0)return;o.value--;const{destination:g,location:w}=l.path_details[o.value],B=[{lng:w.gps.lng,lat:w.gps.lat},{lng:g.gps.lng,lat:g.gps.lat}],v=document.createElement("div"),b=document.getElementById(`map${a.value}`);b&&b.remove(),a.value=Date.now(),v.id="map"+a.value.toString(),(P=h.value)==null||P.appendChild(v),document.getElementById(v.id).style.height="100dvh",document.getElementById(v.id).style.width="100dvw",N(B,v.id)}},z=d=>{s.value=d,x.value=!0};return J(()=>o.value,d=>{i.replace({query:{...i.currentRoute.value.query,step:String(d)}}),d===c.value&&z("抵達")}),K(async()=>{var j;p.value=!0;const{id:d,step:f}=t.query;if(!d){p.value=!1,z("路徑編號錯誤");return}const P={id:Number(d)},g=await ht(P);if(!g.success)return;Object.assign(l,g.data),console.log(g.data),x.value=!1,o.value=f?Number(f):0,c.value=l.path_details.length,p.value=!1;const{destination:w,location:B}=g.data.path_details[o.value],v=[{lng:B.gps.lng,lat:B.gps.lat},{lng:w.gps.lng,lat:w.gps.lat}],b=document.createElement("div");a.value=Date.now(),b.id="map"+a.value.toString(),(j=h.value)==null||j.appendChild(b),document.getElementById(b.id).style.height="100dvh",document.getElementById(b.id).style.width="100dvw",N(v,b.id)}),(d,f)=>{var P,g;return u(),E("div",se,[r("div",{ref_key:"mapRef",ref:h,class:"z-20 absolute w-[100dvw] h-[100dvh] top-0 left-0 flex justify-center items-center bg-gray-900 text-black"},null,512),r("div",ne," 目的地："+T(m(l).destination),1),r("div",ae,[W(jt,{costTime:((P=m(l).path_details[m(o)])==null?void 0:P.costTime)??"-",completedSteps:m(o),totalSteps:m(c),transport:((g=m(l).path_details[m(o)])==null?void 0:g.transport)??{}},null,8,["costTime","completedSteps","totalSteps","transport"])]),r("div",oe,[W(At,{data:m(l).path_details[m(o)]??{},hasNextStep:m(o)<m(c)-1,hasPreviousStep:m(o)>0,onNextStep:f[0]||(f[0]=w=>S("next")),onPreviousStep:f[1]||(f[1]=w=>S("pervious"))},null,8,["data","hasNextStep","hasPreviousStep"])]),m(p)?(u(),I(ct,{key:0})):C("",!0),m(x)?(u(),I(ie,{key:1,title:m(s),onClose:f[2]||(f[2]=w=>x.value=!1)},null,8,["title"])):C("",!0)])}}});export{he as default};
